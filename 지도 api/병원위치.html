<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"/>
    <title>Kakao Map - Nearby Hospitals</title>
</head>
<body>
    <div id="map" style="width:100%;height:100vh;"></div>
    <script src="//dapi.kakao.com/v2/maps/sdk.js?appkey=36d98f4865a05552ba2b55d60a0ac306&libraries=services"></script>
    <!-- <script src="kakao_geomap.js"></script> -->
    <script>
        var mapContainer = document.getElementById('map'),
            mapOption = {
                center: new kakao.maps.LatLng(37.56646, 126.98121),
                level: 3
            };

        var map = new kakao.maps.Map(mapContainer, mapOption);

        // 장소 검색 객체를 생성합니다
        var ps = new kakao.maps.services.Places();

        // 검색 완료 시 호출되는 콜백함수를 정의합니다
        var callback = function(result, status) {
            if (status === kakao.maps.services.Status.OK) {
                console.log(result);

                for (var i = 0; i < result.length; i++) {
                    // 마커를 생성하고 지도에 표시합니다
                    var marker = new kakao.maps.Marker({
                        map: map,
                        position: new kakao.maps.LatLng(result[i].y, result[i].x)
                    });

                    // TODO: 인포윈도우에 표시할 병원 정보 추가
                }
            }
        };

        // 현재 위치를 기반으로 주변 병원을 검색합니다
        navigator.geolocation.getCurrentPosition(function(position) {
            var locPosition = new kakao.maps.LatLng(position.coords.latitude, position.coords.longitude);
            map.setCenter(locPosition);
            ps.keywordSearch('병원', callback, {location: locPosition});
        });
    </script>
</body>
</html>